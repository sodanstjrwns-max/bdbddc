<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Before/After ê´€ë¦¬ | ì„œìš¸ë¹„ë””ì¹˜ê³¼ ê´€ë¦¬ì</title>
  <meta name="robots" content="noindex, nofollow">
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="../images/icons/favicon.svg">
  
  <!-- Fonts & Icons -->
  <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
      background: #0a0a0a;
      color: #fff;
      min-height: 100vh;
    }
    
    /* ========== ê´€ë¦¬ì ë ˆì´ì•„ì›ƒ ========== */
    .admin-layout {
      display: flex;
      min-height: 100vh;
    }
    
    /* ì‚¬ì´ë“œë°” */
    .admin-sidebar {
      width: 260px;
      background: #111;
      border-right: 1px solid rgba(139,90,43,0.2);
      padding: 24px 0;
      position: fixed;
      height: 100vh;
      overflow-y: auto;
    }
    
    .admin-logo {
      padding: 0 24px 24px;
      border-bottom: 1px solid rgba(139,90,43,0.2);
      margin-bottom: 24px;
    }
    
    .admin-logo h1 {
      font-size: 1.25rem;
      color: #C9A962;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .admin-logo span {
      font-size: 0.75rem;
      color: rgba(255,255,255,0.5);
      display: block;
      margin-top: 4px;
    }
    
    .admin-nav {
      list-style: none;
    }
    
    .admin-nav a {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 24px;
      color: rgba(255,255,255,0.7);
      text-decoration: none;
      transition: all 0.3s;
    }
    
    .admin-nav a:hover {
      background: rgba(201,169,98,0.1);
      color: #C9A962;
    }
    
    .admin-nav a.active {
      background: linear-gradient(90deg, rgba(201,169,98,0.2), transparent);
      color: #C9A962;
      border-left: 3px solid #C9A962;
    }
    
    .admin-nav i {
      width: 20px;
      text-align: center;
    }
    
    /* ë©”ì¸ ì½˜í…ì¸  */
    .admin-main {
      flex: 1;
      margin-left: 260px;
      padding: 24px;
    }
    
    .admin-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 32px;
      padding-bottom: 16px;
      border-bottom: 1px solid rgba(139,90,43,0.2);
    }
    
    .admin-header h2 {
      font-size: 1.5rem;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .admin-header h2 i {
      color: #C9A962;
    }
    
    .admin-header-actions {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .btn-logout {
      padding: 8px 16px;
      background: rgba(239,68,68,0.1);
      border: 1px solid rgba(239,68,68,0.3);
      border-radius: 6px;
      color: #ef4444;
      cursor: pointer;
      font-size: 0.85rem;
      transition: all 0.3s;
    }
    
    .btn-logout:hover {
      background: rgba(239,68,68,0.2);
    }
    
    /* ========== í†µê³„ ì¹´ë“œ ========== */
    .stats-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }
    
    .stat-card {
      background: rgba(26, 20, 16, 0.6);
      border: 1px solid rgba(139, 90, 43, 0.2);
      border-radius: 12px;
      padding: 20px;
    }
    
    .stat-card .number {
      font-size: 2rem;
      font-weight: 700;
      color: #C9A962;
    }
    
    .stat-card .label {
      color: rgba(255,255,255,0.6);
      font-size: 0.9rem;
      margin-top: 4px;
    }
    
    /* ========== íˆ´ë°” ========== */
    .toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      flex-wrap: wrap;
      gap: 16px;
    }
    
    .toolbar-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .search-box {
      display: flex;
      align-items: center;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      padding: 8px 12px;
      width: 280px;
    }
    
    .search-box i {
      color: rgba(255,255,255,0.4);
      margin-right: 8px;
    }
    
    .search-box input {
      background: none;
      border: none;
      color: #fff;
      outline: none;
      width: 100%;
      font-size: 0.9rem;
    }
    
    .filter-select {
      padding: 10px 16px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      color: #fff;
      font-size: 0.9rem;
      cursor: pointer;
    }
    
    .filter-select option {
      background: #1a1510;
      color: #fff;
    }
    
    .btn-primary {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 20px;
      background: linear-gradient(135deg, #8B5A2B, #C9A962);
      border: none;
      border-radius: 8px;
      color: #fff;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(201,169,98,0.3);
    }
    
    /* ========== í…Œì´ë¸” ========== */
    .data-table {
      background: rgba(26, 20, 16, 0.6);
      border: 1px solid rgba(139, 90, 43, 0.2);
      border-radius: 12px;
      overflow: hidden;
    }
    
    .data-table table {
      width: 100%;
      border-collapse: collapse;
    }
    
    .data-table th,
    .data-table td {
      padding: 14px 16px;
      text-align: left;
    }
    
    .data-table th {
      background: rgba(139,90,43,0.1);
      font-weight: 600;
      font-size: 0.85rem;
      color: #C9A962;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .data-table tr:not(:last-child) {
      border-bottom: 1px solid rgba(139,90,43,0.1);
    }
    
    .data-table tbody tr:hover {
      background: rgba(201,169,98,0.05);
    }
    
    .case-thumbnail {
      display: flex;
      gap: 8px;
    }
    
    .case-thumbnail img {
      width: 60px;
      height: 45px;
      object-fit: cover;
      border-radius: 6px;
      border: 1px solid rgba(139,90,43,0.3);
    }
    
    .case-thumbnail .placeholder {
      width: 60px;
      height: 45px;
      background: rgba(139,90,43,0.2);
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.65rem;
      color: rgba(255,255,255,0.4);
      border: 1px dashed rgba(139,90,43,0.4);
    }
    
    .status-badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 600;
    }
    
    .status-badge.published {
      background: rgba(34,197,94,0.2);
      color: #22c55e;
    }
    
    .status-badge.draft {
      background: rgba(234,179,8,0.2);
      color: #eab308;
    }
    
    .category-badge {
      display: inline-block;
      padding: 4px 10px;
      background: rgba(201,169,98,0.15);
      color: #C9A962;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 500;
    }
    
    .action-btns {
      display: flex;
      gap: 8px;
    }
    
    .btn-icon {
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 6px;
      color: rgba(255,255,255,0.7);
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .btn-icon:hover {
      background: rgba(201,169,98,0.1);
      border-color: rgba(201,169,98,0.3);
      color: #C9A962;
    }
    
    .btn-icon.delete:hover {
      background: rgba(239,68,68,0.1);
      border-color: rgba(239,68,68,0.3);
      color: #ef4444;
    }
    
    /* ========== ëª¨ë‹¬ ========== */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.85);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    
    .modal-overlay.active {
      display: flex;
    }
    
    .modal {
      background: #1a1510;
      border: 1px solid rgba(139,90,43,0.3);
      border-radius: 16px;
      width: 100%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 24px;
      border-bottom: 1px solid rgba(139,90,43,0.2);
      position: sticky;
      top: 0;
      background: #1a1510;
      z-index: 10;
    }
    
    .modal-header h3 {
      font-size: 1.25rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .modal-header h3 i {
      color: #C9A962;
    }
    
    .modal-close {
      background: none;
      border: none;
      color: rgba(255,255,255,0.5);
      font-size: 1.5rem;
      cursor: pointer;
      padding: 8px;
      border-radius: 8px;
      transition: all 0.3s;
    }
    
    .modal-close:hover {
      background: rgba(255,255,255,0.1);
      color: #fff;
    }
    
    .modal-body {
      padding: 24px;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: rgba(255,255,255,0.9);
    }
    
    .form-group label .required {
      color: #ef4444;
      margin-left: 4px;
    }
    
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 12px 16px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      color: #fff;
      font-size: 0.95rem;
      outline: none;
      transition: border-color 0.3s;
    }
    
    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      border-color: rgba(201,169,98,0.5);
    }
    
    .form-group input::placeholder,
    .form-group textarea::placeholder {
      color: rgba(255,255,255,0.3);
    }
    
    .form-group textarea {
      min-height: 100px;
      resize: vertical;
    }
    
    .form-group select option {
      background: #1a1510;
      color: #fff;
    }
    
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }
    
    /* ========== ì´ë¯¸ì§€ ì—…ë¡œë“œ ì˜ì—­ (ê°•í™”) ========== */
    .image-upload-section {
      margin-bottom: 24px;
    }
    
    .image-upload-section h4 {
      font-size: 1rem;
      color: #C9A962;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .image-upload-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    
    .image-upload-box {
      background: rgba(0,0,0,0.3);
      border: 2px dashed rgba(139,90,43,0.4);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      position: relative;
      min-height: 200px;
    }
    
    .image-upload-box:hover {
      border-color: rgba(201,169,98,0.6);
      background: rgba(201,169,98,0.05);
    }
    
    .image-upload-box.dragover {
      border-color: #C9A962;
      background: rgba(201,169,98,0.1);
      transform: scale(1.02);
    }
    
    .image-upload-box.has-image {
      border-style: solid;
      border-color: rgba(201,169,98,0.5);
    }
    
    .image-upload-box .upload-label {
      position: absolute;
      top: 10px;
      left: 10px;
      padding: 4px 10px;
      border-radius: 4px;
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .image-upload-box.before .upload-label {
      background: rgba(239,68,68,0.8);
      color: #fff;
    }
    
    .image-upload-box.after .upload-label {
      background: rgba(34,197,94,0.8);
      color: #fff;
    }
    
    .image-upload-box .upload-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 160px;
    }
    
    .image-upload-box .upload-content i {
      font-size: 2.5rem;
      color: rgba(201,169,98,0.5);
      margin-bottom: 12px;
    }
    
    .image-upload-box .upload-content p {
      color: rgba(255,255,255,0.6);
      font-size: 0.85rem;
      margin-bottom: 4px;
    }
    
    .image-upload-box .upload-content small {
      color: rgba(255,255,255,0.4);
      font-size: 0.75rem;
    }
    
    .image-upload-box input[type="file"] {
      display: none;
    }
    
    .image-preview-container {
      position: relative;
      height: 160px;
      display: none;
    }
    
    .image-preview-container.active {
      display: block;
    }
    
    .image-preview-container img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      border-radius: 8px;
      background: rgba(0,0,0,0.5);
    }
    
    .image-preview-container .remove-image {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 28px;
      height: 28px;
      background: rgba(239,68,68,0.9);
      border: none;
      border-radius: 50%;
      color: #fff;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      transition: all 0.3s;
    }
    
    .image-preview-container .remove-image:hover {
      background: #ef4444;
      transform: scale(1.1);
    }
    
    .image-url-input {
      margin-top: 12px;
    }
    
    .image-url-input input {
      padding: 10px 12px;
      font-size: 0.85rem;
    }
    
    .image-url-input small {
      display: block;
      margin-top: 4px;
      color: rgba(255,255,255,0.4);
      font-size: 0.75rem;
    }
    
    .modal-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      padding: 16px 24px;
      border-top: 1px solid rgba(139,90,43,0.2);
      position: sticky;
      bottom: 0;
      background: #1a1510;
    }
    
    .modal-footer-left {
      display: flex;
      align-items: center;
      gap: 8px;
      color: rgba(255,255,255,0.5);
      font-size: 0.8rem;
    }
    
    .modal-footer-right {
      display: flex;
      gap: 12px;
    }
    
    .btn-secondary {
      padding: 10px 20px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 8px;
      color: #fff;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .btn-secondary:hover {
      background: rgba(255,255,255,0.1);
    }
    
    /* ========== ë¡œë”©/ë¹ˆ ìƒíƒœ ========== */
    .loading-state,
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: rgba(255,255,255,0.6);
    }
    
    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 3px solid rgba(201,169,98,0.2);
      border-top-color: #C9A962;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 16px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .empty-state i {
      font-size: 3rem;
      color: rgba(201,169,98,0.3);
      margin-bottom: 16px;
    }
    
    .empty-state h3 {
      color: #fff;
      margin-bottom: 8px;
    }
    
    /* ========== ì•Œë¦¼ í† ìŠ¤íŠ¸ ========== */
    .toast {
      position: fixed;
      bottom: 24px;
      right: 24px;
      padding: 16px 24px;
      background: #1a1510;
      border: 1px solid rgba(139,90,43,0.3);
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.4);
      display: flex;
      align-items: center;
      gap: 12px;
      z-index: 2000;
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s;
    }
    
    .toast.show {
      transform: translateY(0);
      opacity: 1;
    }
    
    .toast.success {
      border-color: rgba(34,197,94,0.5);
    }
    
    .toast.success i {
      color: #22c55e;
    }
    
    .toast.error {
      border-color: rgba(239,68,68,0.5);
    }
    
    .toast.error i {
      color: #ef4444;
    }
    
    /* ========== ë°˜ì‘í˜• ========== */
    @media (max-width: 1024px) {
      .admin-sidebar {
        display: none;
      }
      
      .admin-main {
        margin-left: 0;
      }
      
      .form-row,
      .image-upload-row {
        grid-template-columns: 1fr;
      }
    }
    
    @media (max-width: 768px) {
      .toolbar {
        flex-direction: column;
        align-items: stretch;
      }
      
      .toolbar-left {
        flex-direction: column;
      }
      
      .search-box {
        width: 100%;
      }
      
      .data-table {
        overflow-x: auto;
      }
      
      .data-table table {
        min-width: 800px;
      }
      
      .stats-row {
        grid-template-columns: 1fr 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- ê´€ë¦¬ì ë ˆì´ì•„ì›ƒ -->
  <div class="admin-layout" id="adminLayout">
    <!-- ì‚¬ì´ë“œë°” -->
    <aside class="admin-sidebar">
      <div class="admin-logo">
        <h1>ğŸ¦· ì„œìš¸ë¹„ë””ì¹˜ê³¼</h1>
        <span>ê´€ë¦¬ì íŒ¨ë„</span>
      </div>
      <nav>
        <ul class="admin-nav">
          <li><a href="index.html"><i class="fas fa-home"></i> ëŒ€ì‹œë³´ë“œ</a></li>
          <li><a href="cases.html" class="active"><i class="fas fa-images"></i> Before/After</a></li>
          <li><a href="notices.html"><i class="fas fa-bullhorn"></i> ê³µì§€ì‚¬í•­</a></li>
          <li><a href="../index.html" target="_blank"><i class="fas fa-external-link-alt"></i> ì‚¬ì´íŠ¸ ë³´ê¸°</a></li>
        </ul>
      </nav>
    </aside>
    
    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <main class="admin-main">
      <header class="admin-header">
        <h2><i class="fas fa-images"></i> Before/After ê´€ë¦¬</h2>
        <div class="admin-header-actions">
          <a href="../cases/gallery.html" target="_blank" class="btn-secondary" style="text-decoration:none; display:inline-flex; align-items:center; gap:6px;">
            <i class="fas fa-eye"></i> ê°¤ëŸ¬ë¦¬ ë¯¸ë¦¬ë³´ê¸°
          </a>
        </div>
      </header>
      
      <!-- í†µê³„ ì¹´ë“œ -->
      <div class="stats-row">
        <div class="stat-card">
          <div class="number" id="statTotal">0</div>
          <div class="label">ì´ ì¼€ì´ìŠ¤</div>
        </div>
        <div class="stat-card">
          <div class="number" id="statPublished">0</div>
          <div class="label">ê³µê°œ ì¤‘</div>
        </div>
        <div class="stat-card">
          <div class="number" id="statDraft">0</div>
          <div class="label">ë¹„ê³µê°œ</div>
        </div>
        <div class="stat-card">
          <div class="number" id="statThisMonth">0</div>
          <div class="label">ì´ë²ˆ ë‹¬ ë“±ë¡</div>
        </div>
      </div>
      
      <!-- íˆ´ë°” -->
      <div class="toolbar">
        <div class="toolbar-left">
          <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="ì œëª©, ë‹´ë‹¹ì˜ë¡œ ê²€ìƒ‰..." id="searchInput" oninput="filterCases()">
          </div>
          <select class="filter-select" id="categoryFilter" onchange="filterCases()">
            <option value="all">ì „ì²´ ì¹´í…Œê³ ë¦¬</option>
            <option value="implant">ì„í”Œë€íŠ¸</option>
            <option value="orthodontic">êµì •</option>
            <option value="aesthetic">ì‹¬ë¯¸ì¹˜ë£Œ</option>
            <option value="whitening">ë¯¸ë°±</option>
            <option value="gum">ì‡ëª¸ì¹˜ë£Œ</option>
            <option value="general">ì¼ë°˜ì§„ë£Œ</option>
          </select>
          <select class="filter-select" id="statusFilter" onchange="filterCases()">
            <option value="all">ì „ì²´ ìƒíƒœ</option>
            <option value="published">ê³µê°œ</option>
            <option value="draft">ë¹„ê³µê°œ</option>
          </select>
        </div>
        <button class="btn-primary" onclick="openModal()">
          <i class="fas fa-plus"></i> ìƒˆ ì¼€ì´ìŠ¤ ì¶”ê°€
        </button>
      </div>
      
      <!-- ë°ì´í„° í…Œì´ë¸” -->
      <div class="data-table">
        <table>
          <thead>
            <tr>
              <th>ì´ë¯¸ì§€</th>
              <th>ì œëª©</th>
              <th>ì¹´í…Œê³ ë¦¬</th>
              <th>ë‹´ë‹¹ì˜</th>
              <th>ì¹˜ë£Œê¸°ê°„</th>
              <th>ìƒíƒœ</th>
              <th>ë“±ë¡ì¼</th>
              <th>ê´€ë¦¬</th>
            </tr>
          </thead>
          <tbody id="casesTableBody">
            <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
          </tbody>
        </table>
        
        <!-- ë¡œë”© ìƒíƒœ -->
        <div id="loadingState" class="loading-state" style="display: none;">
          <div class="loading-spinner"></div>
          <p>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        </div>
        
        <!-- ë¹ˆ ìƒíƒœ -->
        <div id="emptyState" class="empty-state" style="display: none;">
          <i class="fas fa-folder-open"></i>
          <h3>ë“±ë¡ëœ ì¼€ì´ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤</h3>
          <p>ìƒˆ ì¼€ì´ìŠ¤ë¥¼ ì¶”ê°€í•˜ì—¬ Before/After ê°¤ëŸ¬ë¦¬ë¥¼ ì±„ì›Œë³´ì„¸ìš”!</p>
        </div>
      </div>
    </main>
  </div>
  
  <!-- ì¼€ì´ìŠ¤ ì¶”ê°€/ìˆ˜ì • ëª¨ë‹¬ -->
  <div class="modal-overlay" id="caseModal">
    <div class="modal">
      <div class="modal-header">
        <h3><i class="fas fa-plus-circle"></i> <span id="modalTitle">ìƒˆ ì¼€ì´ìŠ¤ ì¶”ê°€</span></h3>
        <button class="modal-close" onclick="closeModal()">Ã—</button>
      </div>
      <div class="modal-body">
        <form id="caseForm">
          <input type="hidden" id="caseId">
          
          <div class="form-group">
            <label>ì œëª© <span class="required">*</span></label>
            <input type="text" id="caseTitle" required placeholder="ì˜ˆ: ì „ì•… ì„í”Œë€íŠ¸ ìˆ˜ë³µ, ì¸ë¹„ì ˆë¼ì¸ êµì • ì™„ë£Œ">
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>ì¹´í…Œê³ ë¦¬ <span class="required">*</span></label>
              <select id="caseCategory" required>
                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                <option value="implant">ì„í”Œë€íŠ¸</option>
                <option value="orthodontic">êµì •</option>
                <option value="aesthetic">ì‹¬ë¯¸ì¹˜ë£Œ</option>
                <option value="whitening">ë¯¸ë°±</option>
                <option value="gum">ì‡ëª¸ì¹˜ë£Œ</option>
                <option value="general">ì¼ë°˜ì§„ë£Œ</option>
              </select>
            </div>
            <div class="form-group">
              <label>ë‹´ë‹¹ ì›ì¥ <span class="required">*</span></label>
              <select id="doctorName" required>
                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                <optgroup label="ëŒ€í‘œì›ì¥">
                  <option value="ë¬¸ì„ì¤€ ì›ì¥">ë¬¸ì„ì¤€ ì›ì¥ (í†µí•©ì¹˜ì˜í•™)</option>
                </optgroup>
                <optgroup label="ì„í”Œë€íŠ¸ ì„¼í„°">
                  <option value="ì´ìŠ¹ì—½ ì›ì¥">ì´ìŠ¹ì—½ ì›ì¥ (ì„í”Œë€íŠ¸ ì„¼í„°ì¥)</option>
                  <option value="ê°•ê²½ë¯¼ ì›ì¥">ê°•ê²½ë¯¼ ì›ì¥ (êµ¬ê°•ì™¸ê³¼)</option>
                </optgroup>
                <optgroup label="êµì •ê³¼">
                  <option value="ê¹€ë¯¼ê·œ ì›ì¥">ê¹€ë¯¼ê·œ ì›ì¥ (êµì •ê³¼ ì „ë¬¸ì˜)</option>
                </optgroup>
                <optgroup label="ì¹˜ê³¼ë³´ì¡´ê³¼">
                  <option value="ì¡°ì„¤ì•„ ì›ì¥">ì¡°ì„¤ì•„ ì›ì¥ (ì¹˜ê³¼ë³´ì¡´ê³¼ ì „ë¬¸ì˜)</option>
                  <option value="ê°•ë¯¼ì§€ ì›ì¥">ê°•ë¯¼ì§€ ì›ì¥ (ì¹˜ê³¼ë³´ì¡´ê³¼)</option>
                </optgroup>
                <optgroup label="ì†Œì•„ì¹˜ê³¼">
                  <option value="ê¹€ë¯¼ì§„ ì›ì¥">ê¹€ë¯¼ì§„ ì›ì¥ (ì†Œì•„ì¹˜ê³¼ ì „ë¬¸ì˜)</option>
                  <option value="ë°•ìƒí˜„ ì›ì¥">ë°•ìƒí˜„ ì›ì¥ (ì†Œì•„ì¹˜ê³¼)</option>
                </optgroup>
                <optgroup label="êµ¬ê°•ë‚´ê³¼">
                  <option value="ì´ë³‘ë¯¼ ì›ì¥">ì´ë³‘ë¯¼ ì›ì¥ (êµ¬ê°•ë‚´ê³¼ ì „ë¬¸ì˜)</option>
                </optgroup>
                <optgroup label="ì‹¬ë¯¸ì¹˜ë£Œ">
                  <option value="í˜„ì •ë¯¼ ì›ì¥">í˜„ì •ë¯¼ ì›ì¥ (ì‹¬ë¯¸ì¹˜ë£Œ)</option>
                  <option value="ì„œí¬ì› ì›ì¥">ì„œí¬ì› ì›ì¥ (ë³´ì² ê³¼)</option>
                </optgroup>
                <optgroup label="ì¢…í•©ì§„ë£Œ">
                  <option value="ìµœì¢…í›ˆ ì›ì¥">ìµœì¢…í›ˆ ì›ì¥ (ì¢…í•©ì§„ë£Œì„¼í„°ì¥)</option>
                  <option value="ê¹€ë¯¼ìˆ˜ ì›ì¥">ê¹€ë¯¼ìˆ˜ ì›ì¥ (ì¢…í•©ì§„ë£Œ)</option>
                  <option value="ì„ì§€ì› ì›ì¥">ì„ì§€ì› ì›ì¥ (ì¢…í•©ì§„ë£Œ)</option>
                  <option value="ë°•ìˆ˜ë¹ˆ ì›ì¥">ë°•ìˆ˜ë¹ˆ ì›ì¥ (ì¢…í•©ì§„ë£Œ)</option>
                </optgroup>
              </select>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>ì¹˜ë£Œ ê¸°ê°„</label>
              <input type="text" id="treatmentPeriod" placeholder="ì˜ˆ: 6ê°œì›”, 1ë…„, 2ì£¼">
            </div>
            <div class="form-group">
              <label>ìƒíƒœ</label>
              <select id="caseStatus">
                <option value="published">ê³µê°œ</option>
                <option value="draft">ë¹„ê³µê°œ</option>
              </select>
            </div>
          </div>
          
          <div class="form-group">
            <label>ì„¤ëª…</label>
            <textarea id="caseDescription" placeholder="ì¼€ì´ìŠ¤ì— ëŒ€í•œ ìƒì„¸ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”. ì¹˜ë£Œ ê³¼ì •, íŠ¹ì´ì‚¬í•­ ë“±"></textarea>
          </div>
          
          <!-- ì´ë¯¸ì§€ ì—…ë¡œë“œ ì„¹ì…˜ -->
          <div class="image-upload-section">
            <h4><i class="fas fa-camera"></i> Before / After ì´ë¯¸ì§€</h4>
            <div class="image-upload-row">
              <!-- Before ì´ë¯¸ì§€ -->
              <div class="image-upload-box before" 
                   onclick="document.getElementById('beforeImage').click()"
                   ondragover="handleDragOver(event, this)"
                   ondragleave="handleDragLeave(event, this)"
                   ondrop="handleDrop(event, this, 'before')">
                <span class="upload-label">Before</span>
                <div class="upload-content" id="beforeUploadContent">
                  <i class="fas fa-cloud-upload-alt"></i>
                  <p>í´ë¦­ ë˜ëŠ” ë“œë˜ê·¸í•˜ì—¬ ì—…ë¡œë“œ</p>
                  <small>JPG, PNG, WebP (5MB ì´í•˜)</small>
                </div>
                <div class="image-preview-container" id="beforePreviewContainer">
                  <img id="beforePreview" src="" alt="Before Preview">
                  <button type="button" class="remove-image" onclick="removeImage(event, 'before')">
                    <i class="fas fa-times"></i>
                  </button>
                </div>
                <input type="file" id="beforeImage" accept="image/*" onchange="handleFileSelect(this, 'before')">
              </div>
              
              <!-- After ì´ë¯¸ì§€ -->
              <div class="image-upload-box after" 
                   onclick="document.getElementById('afterImage').click()"
                   ondragover="handleDragOver(event, this)"
                   ondragleave="handleDragLeave(event, this)"
                   ondrop="handleDrop(event, this, 'after')">
                <span class="upload-label">After</span>
                <div class="upload-content" id="afterUploadContent">
                  <i class="fas fa-cloud-upload-alt"></i>
                  <p>í´ë¦­ ë˜ëŠ” ë“œë˜ê·¸í•˜ì—¬ ì—…ë¡œë“œ</p>
                  <small>JPG, PNG, WebP (5MB ì´í•˜)</small>
                </div>
                <div class="image-preview-container" id="afterPreviewContainer">
                  <img id="afterPreview" src="" alt="After Preview">
                  <button type="button" class="remove-image" onclick="removeImage(event, 'after')">
                    <i class="fas fa-times"></i>
                  </button>
                </div>
                <input type="file" id="afterImage" accept="image/*" onchange="handleFileSelect(this, 'after')">
              </div>
            </div>
            
            <!-- URL ì§ì ‘ ì…ë ¥ ì˜µì…˜ -->
            <div style="margin-top: 16px; padding-top: 16px; border-top: 1px dashed rgba(139,90,43,0.3);">
              <p style="color: rgba(255,255,255,0.5); font-size: 0.8rem; margin-bottom: 12px;">
                <i class="fas fa-link"></i> ë˜ëŠ” ì´ë¯¸ì§€ URLì„ ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”
              </p>
              <div class="form-row">
                <div class="image-url-input">
                  <input type="url" id="beforeImageUrl" placeholder="Before ì´ë¯¸ì§€ URL (https://...)" 
                         oninput="loadImageFromUrl(this.value, 'before')">
                </div>
                <div class="image-url-input">
                  <input type="url" id="afterImageUrl" placeholder="After ì´ë¯¸ì§€ URL (https://...)"
                         oninput="loadImageFromUrl(this.value, 'after')">
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <div class="modal-footer-left">
          <i class="fas fa-info-circle"></i>
          <span>ì´ë¯¸ì§€ëŠ” ë¸Œë¼ìš°ì € ë¡œì»¬ì— ì €ì¥ë©ë‹ˆë‹¤</span>
        </div>
        <div class="modal-footer-right">
          <button class="btn-secondary" type="button" onclick="closeModal()">ì·¨ì†Œ</button>
          <button class="btn-primary" type="button" onclick="saveCase()">
            <i class="fas fa-save"></i> ì €ì¥í•˜ê¸°
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ì•Œë¦¼ í† ìŠ¤íŠ¸ -->
  <div class="toast" id="toast">
    <i class="fas fa-check-circle"></i>
    <span id="toastMessage">ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤</span>
  </div>

  <script>
    /**
     * Before/After ê´€ë¦¬ì í˜ì´ì§€ - Enhanced Version
     * localStorage ê¸°ë°˜ ë°ì´í„° ì €ì¥
     */
    
    const STORAGE_KEY = 'bdbddc_before_after_cases';
    let allCases = [];
    let filteredCases = [];
    let editingId = null;
    let beforeImageData = null;
    let afterImageData = null;
    
    // í˜ì´ì§€ ë¡œë“œ
    document.addEventListener('DOMContentLoaded', function() {
      loadCases();
    });
    
    // ========== ë°ì´í„° ê´€ë¦¬ ==========
    
    function loadCases() {
      try {
        const stored = localStorage.getItem(STORAGE_KEY);
        allCases = stored ? JSON.parse(stored) : [];
      } catch (e) {
        console.error('ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', e);
        allCases = [];
      }
      
      filteredCases = [...allCases];
      renderTable();
      updateStats();
    }
    
    function saveCasesToStorage() {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(allCases));
        return true;
      } catch (e) {
        console.error('ì €ì¥ ì‹¤íŒ¨:', e);
        if (e.name === 'QuotaExceededError') {
          showToast('ì €ì¥ ê³µê°„ì´ ë¶€ì¡±í•©ë‹ˆë‹¤. ì¼ë¶€ ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•´ì£¼ì„¸ìš”.', 'error');
        }
        return false;
      }
    }
    
    // ========== í†µê³„ ì—…ë°ì´íŠ¸ ==========
    
    function updateStats() {
      const total = allCases.length;
      const published = allCases.filter(c => c.status === 'published').length;
      const draft = allCases.filter(c => c.status === 'draft').length;
      
      const now = new Date();
      const thisMonth = allCases.filter(c => {
        const date = new Date(c.created_at);
        return date.getMonth() === now.getMonth() && date.getFullYear() === now.getFullYear();
      }).length;
      
      document.getElementById('statTotal').textContent = total;
      document.getElementById('statPublished').textContent = published;
      document.getElementById('statDraft').textContent = draft;
      document.getElementById('statThisMonth').textContent = thisMonth;
    }
    
    // ========== í…Œì´ë¸” ë Œë”ë§ ==========
    
    function renderTable() {
      const tableBody = document.getElementById('casesTableBody');
      const loadingState = document.getElementById('loadingState');
      const emptyState = document.getElementById('emptyState');
      
      loadingState.style.display = 'none';
      
      if (filteredCases.length === 0) {
        tableBody.innerHTML = '';
        emptyState.style.display = 'block';
        return;
      }
      
      emptyState.style.display = 'none';
      tableBody.innerHTML = filteredCases.map(c => createTableRow(c)).join('');
    }
    
    function createTableRow(caseItem) {
      const categoryLabels = {
        implant: 'ì„í”Œë€íŠ¸',
        orthodontic: 'êµì •',
        aesthetic: 'ì‹¬ë¯¸ì¹˜ë£Œ',
        whitening: 'ë¯¸ë°±',
        gum: 'ì‡ëª¸ì¹˜ë£Œ',
        general: 'ì¼ë°˜ì§„ë£Œ'
      };
      
      const statusClass = caseItem.status === 'published' ? 'published' : 'draft';
      const statusLabel = caseItem.status === 'published' ? 'ê³µê°œ' : 'ë¹„ê³µê°œ';
      const date = new Date(caseItem.created_at).toLocaleDateString('ko-KR');
      
      // ì¸ë„¤ì¼ ìƒì„±
      const beforeThumb = caseItem.before_image 
        ? `<img src="${caseItem.before_image}" alt="Before">`
        : `<div class="placeholder">Before</div>`;
      const afterThumb = caseItem.after_image 
        ? `<img src="${caseItem.after_image}" alt="After">`
        : `<div class="placeholder">After</div>`;
      
      return `
        <tr data-id="${caseItem.id}">
          <td>
            <div class="case-thumbnail">
              ${beforeThumb}
              ${afterThumb}
            </div>
          </td>
          <td><strong>${escapeHtml(caseItem.title)}</strong></td>
          <td><span class="category-badge">${categoryLabels[caseItem.category] || caseItem.category}</span></td>
          <td>${escapeHtml(caseItem.doctor_name || '-')}</td>
          <td>${escapeHtml(caseItem.treatment_period || '-')}</td>
          <td><span class="status-badge ${statusClass}">${statusLabel}</span></td>
          <td>${date}</td>
          <td>
            <div class="action-btns">
              <button class="btn-icon" onclick="editCase('${caseItem.id}')" title="ìˆ˜ì •">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn-icon" onclick="toggleStatus('${caseItem.id}')" title="ìƒíƒœ ë³€ê²½">
                <i class="fas fa-eye${caseItem.status === 'published' ? '' : '-slash'}"></i>
              </button>
              <button class="btn-icon delete" onclick="deleteCase('${caseItem.id}')" title="ì‚­ì œ">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        </tr>
      `;
    }
    
    // ========== í•„í„°ë§ ==========
    
    function filterCases() {
      const search = document.getElementById('searchInput').value.toLowerCase();
      const category = document.getElementById('categoryFilter').value;
      const status = document.getElementById('statusFilter').value;
      
      filteredCases = allCases.filter(c => {
        const matchSearch = !search || 
          c.title.toLowerCase().includes(search) || 
          (c.doctor_name && c.doctor_name.toLowerCase().includes(search));
        const matchCategory = category === 'all' || c.category === category;
        const matchStatus = status === 'all' || c.status === status;
        
        return matchSearch && matchCategory && matchStatus;
      });
      
      renderTable();
    }
    
    // ========== ëª¨ë‹¬ ê´€ë¦¬ ==========
    
    function openModal(id = null) {
      editingId = id;
      beforeImageData = null;
      afterImageData = null;
      
      // ëª¨ë‹¬ ì œëª© ì„¤ì •
      document.getElementById('modalTitle').innerHTML = id 
        ? '<i class="fas fa-edit"></i> ì¼€ì´ìŠ¤ ìˆ˜ì •' 
        : '<i class="fas fa-plus-circle"></i> ìƒˆ ì¼€ì´ìŠ¤ ì¶”ê°€';
      
      // í¼ ì´ˆê¸°í™”
      document.getElementById('caseForm').reset();
      resetImageUpload('before');
      resetImageUpload('after');
      
      if (id) {
        // ìˆ˜ì • ëª¨ë“œ: ê¸°ì¡´ ë°ì´í„° ë¡œë“œ
        const caseItem = allCases.find(c => c.id === id);
        if (caseItem) {
          document.getElementById('caseId').value = caseItem.id;
          document.getElementById('caseTitle').value = caseItem.title || '';
          document.getElementById('caseCategory').value = caseItem.category || '';
          document.getElementById('doctorName').value = caseItem.doctor_name || '';
          document.getElementById('treatmentPeriod').value = caseItem.treatment_period || '';
          document.getElementById('caseStatus').value = caseItem.status || 'published';
          document.getElementById('caseDescription').value = caseItem.description || '';
          
          // ì´ë¯¸ì§€ ë¡œë“œ
          if (caseItem.before_image) {
            beforeImageData = caseItem.before_image;
            showImagePreview('before', caseItem.before_image);
            document.getElementById('beforeImageUrl').value = caseItem.before_image.startsWith('data:') ? '' : caseItem.before_image;
          }
          if (caseItem.after_image) {
            afterImageData = caseItem.after_image;
            showImagePreview('after', caseItem.after_image);
            document.getElementById('afterImageUrl').value = caseItem.after_image.startsWith('data:') ? '' : caseItem.after_image;
          }
        }
      }
      
      document.getElementById('caseModal').classList.add('active');
      document.body.style.overflow = 'hidden';
    }
    
    function closeModal() {
      document.getElementById('caseModal').classList.remove('active');
      document.body.style.overflow = '';
      editingId = null;
      beforeImageData = null;
      afterImageData = null;
    }
    
    // ========== ì´ë¯¸ì§€ ì²˜ë¦¬ ==========
    
    function handleDragOver(e, element) {
      e.preventDefault();
      e.stopPropagation();
      element.classList.add('dragover');
    }
    
    function handleDragLeave(e, element) {
      e.preventDefault();
      e.stopPropagation();
      element.classList.remove('dragover');
    }
    
    function handleDrop(e, element, type) {
      e.preventDefault();
      e.stopPropagation();
      element.classList.remove('dragover');
      
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        processImageFile(files[0], type);
      }
    }
    
    function handleFileSelect(input, type) {
      if (input.files && input.files[0]) {
        processImageFile(input.files[0], type);
      }
    }
    
    function processImageFile(file, type) {
      // íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬
      if (!file.type.startsWith('image/')) {
        showToast('ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.', 'error');
        return;
      }
      
      if (file.size > 5 * 1024 * 1024) {
        showToast('5MB ì´í•˜ì˜ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.', 'error');
        return;
      }
      
      const reader = new FileReader();
      reader.onload = function(e) {
        const imageData = e.target.result;
        
        // ì´ë¯¸ì§€ ë¦¬ì‚¬ì´ì§• (ì €ì¥ ê³µê°„ ì ˆì•½)
        resizeImage(imageData, 800, 600, function(resizedData) {
          if (type === 'before') {
            beforeImageData = resizedData;
          } else {
            afterImageData = resizedData;
          }
          showImagePreview(type, resizedData);
        });
      };
      reader.readAsDataURL(file);
    }
    
    function resizeImage(dataUrl, maxWidth, maxHeight, callback) {
      const img = new Image();
      img.onload = function() {
        let width = img.width;
        let height = img.height;
        
        if (width > maxWidth || height > maxHeight) {
          const ratio = Math.min(maxWidth / width, maxHeight / height);
          width *= ratio;
          height *= ratio;
        }
        
        const canvas = document.createElement('canvas');
        canvas.width = width;
        canvas.height = height;
        
        const ctx = canvas.getContext('2d');
        ctx.drawImage(img, 0, 0, width, height);
        
        callback(canvas.toDataURL('image/jpeg', 0.8));
      };
      img.src = dataUrl;
    }
    
    function loadImageFromUrl(url, type) {
      if (!url) return;
      
      // URL ìœ íš¨ì„± ê²€ì‚¬
      if (!url.startsWith('http://') && !url.startsWith('https://')) {
        return;
      }
      
      if (type === 'before') {
        beforeImageData = url;
      } else {
        afterImageData = url;
      }
      showImagePreview(type, url);
    }
    
    function showImagePreview(type, src) {
      const uploadContent = document.getElementById(`${type}UploadContent`);
      const previewContainer = document.getElementById(`${type}PreviewContainer`);
      const preview = document.getElementById(`${type}Preview`);
      const uploadBox = document.querySelector(`.image-upload-box.${type}`);
      
      preview.src = src;
      uploadContent.style.display = 'none';
      previewContainer.classList.add('active');
      uploadBox.classList.add('has-image');
    }
    
    function resetImageUpload(type) {
      const uploadContent = document.getElementById(`${type}UploadContent`);
      const previewContainer = document.getElementById(`${type}PreviewContainer`);
      const preview = document.getElementById(`${type}Preview`);
      const uploadBox = document.querySelector(`.image-upload-box.${type}`);
      const fileInput = document.getElementById(`${type}Image`);
      const urlInput = document.getElementById(`${type}ImageUrl`);
      
      preview.src = '';
      uploadContent.style.display = 'flex';
      previewContainer.classList.remove('active');
      uploadBox.classList.remove('has-image');
      fileInput.value = '';
      urlInput.value = '';
      
      if (type === 'before') {
        beforeImageData = null;
      } else {
        afterImageData = null;
      }
    }
    
    function removeImage(e, type) {
      e.preventDefault();
      e.stopPropagation();
      resetImageUpload(type);
    }
    
    // ========== CRUD ì‘ì—… ==========
    
    function saveCase() {
      const title = document.getElementById('caseTitle').value.trim();
      const category = document.getElementById('caseCategory').value;
      const doctorName = document.getElementById('doctorName').value;
      
      // í•„ìˆ˜ í•„ë“œ ê²€ì¦
      if (!title) {
        showToast('ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
        document.getElementById('caseTitle').focus();
        return;
      }
      
      if (!category) {
        showToast('ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
        document.getElementById('caseCategory').focus();
        return;
      }
      
      if (!doctorName) {
        showToast('ë‹´ë‹¹ ì›ì¥ì„ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
        document.getElementById('doctorName').focus();
        return;
      }
      
      const caseData = {
        title: title,
        category: category,
        doctor_name: doctorName,
        treatment_period: document.getElementById('treatmentPeriod').value.trim(),
        status: document.getElementById('caseStatus').value,
        description: document.getElementById('caseDescription').value.trim(),
        before_image: beforeImageData || document.getElementById('beforeImageUrl').value.trim(),
        after_image: afterImageData || document.getElementById('afterImageUrl').value.trim(),
        updated_at: Date.now()
      };
      
      if (editingId) {
        // ìˆ˜ì •
        const index = allCases.findIndex(c => c.id === editingId);
        if (index > -1) {
          allCases[index] = { ...allCases[index], ...caseData };
        }
      } else {
        // ìƒˆë¡œ ì¶”ê°€
        caseData.id = Date.now().toString();
        caseData.created_at = Date.now();
        allCases.unshift(caseData);
      }
      
      if (saveCasesToStorage()) {
        showToast(editingId ? 'ì¼€ì´ìŠ¤ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.' : 'ìƒˆ ì¼€ì´ìŠ¤ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
        closeModal();
        filterCases();
        updateStats();
      }
    }
    
    function editCase(id) {
      openModal(id);
    }
    
    function toggleStatus(id) {
      const index = allCases.findIndex(c => c.id === id);
      if (index > -1) {
        allCases[index].status = allCases[index].status === 'published' ? 'draft' : 'published';
        allCases[index].updated_at = Date.now();
        
        if (saveCasesToStorage()) {
          const newStatus = allCases[index].status === 'published' ? 'ê³µê°œ' : 'ë¹„ê³µê°œ';
          showToast(`ì¼€ì´ìŠ¤ê°€ ${newStatus}ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
          filterCases();
          updateStats();
        }
      }
    }
    
    function deleteCase(id) {
      if (!confirm('ì •ë§ ì´ ì¼€ì´ìŠ¤ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì‚­ì œëœ ë°ì´í„°ëŠ” ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
        return;
      }
      
      allCases = allCases.filter(c => c.id !== id);
      
      if (saveCasesToStorage()) {
        showToast('ì¼€ì´ìŠ¤ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
        filterCases();
        updateStats();
      }
    }
    
    // ========== ìœ í‹¸ë¦¬í‹° ==========
    
    function escapeHtml(text) {
      if (!text) return '';
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }
    
    function showToast(message, type = 'success') {
      const toast = document.getElementById('toast');
      const toastMessage = document.getElementById('toastMessage');
      const icon = toast.querySelector('i');
      
      toastMessage.textContent = message;
      toast.className = `toast ${type}`;
      icon.className = type === 'success' ? 'fas fa-check-circle' : 'fas fa-exclamation-circle';
      
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }
    
    // ESCë¡œ ëª¨ë‹¬ ë‹«ê¸°
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeModal();
      }
    });
    
    // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ìœ¼ë¡œ ë‹«ê¸°
    document.getElementById('caseModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeModal();
      }
    });
  </script>
</body>
</html>
